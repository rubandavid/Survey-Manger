<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <title>Register Survey</title>
</head>
<body>
<h1>Register</h1>
<form  id="surveyForm" action="/saveSurvey" method="post">
    Name <input type="text" id="userName" placeholder="Enter Name" name="userName">
    <br>
    Enter Phone : <input  id="mobileNumber" type="number" name="mobileNumber">
    <br>
    Enter OTP : <input  id="otpNumber" type="number" name="otpNumber">
    <br>
    <button id="verifyOtp" class="btn btn-danger" type="button" onclick="validateOTP()">Sent OTP</button>
    <button id="saveSurvey" class="btn btn-dark" type="button" onclick="saveingSurvey()">Save Survey</button>

        <a class="btn btn-primary" role="button" href="/">Back</a>
</form>
<script>
    var otp = 0;
    $('#saveSurvey').prop('disabled', true);
    console.log('Loaded..')
function validateOTP(){
    var xhttp = new XMLHttpRequest();
    var userName = document.getElementById("userName").value;
    var mobileNumber = document.getElementById("mobileNumber").value;
    var obj = {"userName" : userName,"mobileNumber" :mobileNumber};
    $.post("verifyOtp",obj,
        function(data, status){
            otp =data;
            $('#saveSurvey').prop('disabled', false);
            $('#verifyOtp').prop('disabled', true);

        });

}

function saveingSurvey(){
    var userOtp = $("#otpNumber").val();
    var form = document.getElementById("surveyForm");
   if(otp != userOtp){
        alert('Invalid OTP');
        return false;
    }else{
        form.submit();
    }


}

</script>
</body>
</html>